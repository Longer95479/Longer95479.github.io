---
layout: post
title:  "Handcraft Your Own Matrix Library"
date:   2025-11-10 22:30:00 +0800
tags: 
  - programming
  - math 
categories:
  - programming
  - math 
---

视觉惯性里程计的前后端的一些计算，涉及矩阵的运算，一些问题的求解，最终都会转变为方程组的求解，
也与矩阵的运算或线性代数相关，想要从零实现一个 VIO 的前端，主要涉及到 *多视角几何（MVS）*，
而 MVS 中的问题的求解绝大部分也都是转换为方程组的求解，因此从零实现一个矩阵运算库就变成了必要条件。

本文将记录笔者用 C++ 实现一个简单的矩阵运算库（类似于 Eigen 库）的过程。

代码仓库：[handcraft-MVS](github.com/Longer95479/handcraft-MVS)。实现的功能有：

- 矩阵多种方式的构造（初始化）与析构

- 矩阵的操作或运算
    - 加减乘，以及标量除法
    - 赋值
    - 矩阵的转置、L2 范数
    - 矩阵取块

- 矩阵的分解
    - QR分解
    - SVD分解

- 方程组的求解（QR分解 ＋ 回代）

其中，比较值得展开的内容有：

- 类内数据结构的选择（主要服务于取块操作 `.block<>()`，而 `.block<>()` 主要服务于后续的 QR 分解实现），以及 `.block<>()` 的实现方式

- 拷贝构造函数和移动构造函数的不同实现

- 析构函数的实现应避免内存的重复释放和泄露

- 赋值操作符重载，对左值引用和右值引用类型的输入做不同的实现，即 *拷贝* 或 *移动* 的实现

- QR 分解中，通过模板函数的递归实现有限次数的循环

- 迭代使用 QR 分解来实现 SVD 分解

- QR 分解和回代实现方程组的求解

TODO:

- [ ] 赋值操作的深拷贝浅拷贝实现（避免析构时内存重复释放）

- [ ] 目前的 QR 分解、SVD分解和方程组求解只支持 *矩阵行数大于列数* 的情况，待扩展
