---
layout: post
title:  "Singular Value Decomposition(SVD)"
date:   2024-04-27 16:50:00 +0800
tags: 
  - linear algebra
categories:
  - math
---

## Eigen Vector Decomposing

特征值与特征向量的定义和关系可由下面等式给出
$$
Ax = x\lambda
$$

扩展成 n 个特征向量和特征值，有
$$
A
\begin{pmatrix}
x_1 & x_2 & \cdots & x_n
\end{pmatrix}
=
\begin{pmatrix}
x_1 & x_2 & \cdots & x_n
\end{pmatrix}
\begin{pmatrix}
\lambda_1 \\
& \lambda_2 \\
&& \ddots \\
&&& \lambda_n
\end{pmatrix}
$$
简写为
$$
AP= P\Lambda \\
A= P \Lambda P^{-1}
$$
这意味着什么呢？可以从这几个角度理解：
- $A$ 与 $\Lambda$ 相似。两个矩阵相似，代表着同一个线性变换，在不同基下的表示。 $P$ 表示的是*坐标系变换*，$\Lambda$ 表示的是*线性变换*
$$
^{B_1}v \mapsto \ ^{B_1}w =  A \  ^{B_1}v
$$

$$
^{B_2}v \mapsto \ ^{B_2}w =  \Lambda\ ^{B_2}v
$$

$$
\begin{align}
^{B_1}w &= P \  ^{B_2}w \\
        &= P \Lambda \ ^{B_2}v \\
        &= P \Lambda P^{-1} \ ^{B_1}v
\end{align}
$$
- A 这个线性变换被分解为三步（假设 P 正交）：先旋转，后拉伸，再旋转回去


---
已知 $v \mapsto w,\ v,w \in \mathbb{R}^n$，需要 n 个这样的映射才能唯一确定一个线性映射或矩阵
$$
\begin{pmatrix}
v^T & 0_{1\times n} & \cdots &  0_{1\times n}\\
0_{1\times n} & v^T & \cdots &  0_{1\times n}\\
\cdots && \ddots\\
0_{1\times n} & 0_{1\times n} & \cdots & v^T\\
\end{pmatrix}
\begin{pmatrix}
a_{11} \\
a_{12} \\
\dots \\
a_{1n}\\
\cdots\\
a_{nn}
\end{pmatrix}_{n \times n}
=
w
$$
---

## SVD
full matrices: 
$$
A_{mn} = U_{mm}\Sigma_{mn}(V_{nn})^T
$$
![full_matrices](/assets/2024-06-13-SVD/full_matrices.png)

not full matrices:
$$
A_{mn} \approx U_{mr}\Sigma_{mr}(V_{nr})^T, r \leq min(m,n)
$$
![not_full_matrices](assets/2024-06-13-SVD/not_full_matrices.png)


```python
import matplotlib.pyplot as plt
import matplotlib.image as mpimg
import numpy as np

I = mpimg.imread("E:\\Data\\Pictures\\Screenshots\\屏幕截图(1).png");

u, s, vh = np.linalg.svd(I[:,:,0],full_matrices=False)
smat = np.diag(s)
print(smat.shape)

k = 5
I_compress = np.dot(u[:,0:k],np.dot(smat[0:k,0:k],vh[0:k,:]))

plt.subplot(2,1,1)
plt.imshow(I[:,:,0])
plt.subplot(2,1,2)
plt.imshow(I_compress)
plt.show()

```
