---
layout: post
title:  "IMU Preintegration"
date:   2024-11-23 15:15:00 +0800
tags: 
  - Quaternion
categories:
  - math
---


从因子图的角度来看，IMU 预积分解决的问题是：约束的表达式与状态变量的值有关，也就是当状态变量更新后，
约束的表达式变化了，此时需要重新计算约束表达式里的一些参数，而不是能够重复利用固定的约束表达式。
而预计分则可以让原本会变的约束表达式变成固定的表达式，与状态变量无关。


### 预积分整体的推导思路

从两个最基本的方程组出发，一个是动力学方程组，另一个是最原始的测量方程组，之后利用匀速旋转和加速度的假设，进行普通的积分，然后将状态的增量都变换到相邻两帧中的第一帧机体坐标系下，再经过一系列的移项构造，使得方程右侧的参数可从上到下依次计算得出，且与状态无关，从而保证了状态在优化后发生值的变动，不会导致预计分方程右侧需要重新计算。

首先从最基本的动力学方程出发

$$
\dot{R} = R [\omega] \\ 
\dot{v} = a \\
\dot{p} = v
$$

转换成积分形式

$$
R_{i+1} = R_i \oplus \int_{t_i}^{t+1} \omega \mathbf{d}t \\
v_{i+1} = v_i + \int_{t_i}^{t+1} a \mathbf{d}t \\ 
p_{i+1} = p_i + \int_{t_i}^{t+1} v \mathrm{d}t
$$

然后在这段时间内假设 $\omega$ 和 $a$ 是恒定值，也就是进行零阶近似

$$
R_{i+1} = R_i \oplus \omega \Delta t \\
v_{i+1} = v_i + a \Delta t \\
p_{i+1} = p_i + v_i \Delta t + \frac12 a \Delta t^2
$$



